<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DLP/DSPM Competitive Intelligence Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #f5f7fa;
            padding: 20px;
            color: #2c3e50;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .controls input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .controls input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .feed-container {
            display: grid;
            gap: 20px;
        }
        
        .feed-section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .feed-header {
            padding: 20px;
            border-bottom: 2px solid #f0f3f7;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .feed-header h2 {
            font-size: 18px;
            color: #2c3e50;
        }
        
        .company-tag {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .tag-nightfallai { background: #e3f2fd; color: #1976d2; }
        .tag-varonis { background: #f3e5f5; color: #7b1fa2; }
        .tag-forcepoint { background: #fff3e0; color: #ef6c00; }
        .tag-digitalguardian { background: #e8f5e9; color: #388e3c; }
        .tag-proofpoint { background: #e0f2f1; color: #00695c; }
        .tag-symantecdlp { background: #fce4ec; color: #c2185b; }
        .tag-cyera { background: #f1f8e9; color: #558b2f; }
        .tag-bigid { background: #e8eaf6; color: #3949ab; }
        .tag-sentra { background: #fff9c4; color: #f57f17; }
        .tag-normalyze { background: #e1f5fe; color: #0277bd; }
        .tag-laminar { background: #e3f2fd; color: #1976d2; }
        .tag-digsecurity { background: #f3e5f5; color: #7b1fa2; }
        .tag-polarsecurity { background: #fff3e0; color: #ef6c00; }
        .tag-securitiai { background: #e8f5e9; color: #388e3c; }
        .tag-netskope { background: #e0f2f1; color: #00695c; }
        .tag-zscaler { background: #fce4ec; color: #c2185b; }
        .tag-skyhighsecurity { background: #f1f8e9; color: #558b2f; }
        .tag-wiz { background: #e8eaf6; color: #3949ab; }
        .tag-lacework { background: #fff9c4; color: #f57f17; }
        .tag-orcasecurity { background: #e1f5fe; color: #0277bd; }
        .tag-crowdstrike { background: #e3f2fd; color: #1976d2; }
        .tag-sentinelone { background: #f3e5f5; color: #7b1fa2; }
        .tag-code42 { background: #fff3e0; color: #ef6c00; }
        .tag-squarex { background: #e8f5e9; color: #388e3c; }
        .tag-island { background: #e0f2f1; color: #00695c; }
        .tag-talon { background: #fce4ec; color: #c2185b; }
        .tag-layerxsecurity { background: #f1f8e9; color: #558b2f; }
        .tag-seraphicsecurity { background: #e8eaf6; color: #3949ab; }
        .tag-surfsecurity { background: #fff9c4; color: #f57f17; }
        .tag-menlosecurity { background: #e1f5fe; color: #0277bd; }
        .tag-camunda { background: #e3f2fd; color: #1976d2; }
        .tag-processmaker { background: #f3e5f5; color: #7b1fa2; }
        .tag-appian { background: #fff3e0; color: #ef6c00; }
        .tag-pega { background: #e8f5e9; color: #388e3c; }
        .tag-nintex { background: #e0f2f1; color: #00695c; }
        .tag-bizagi { background: #fce4ec; color: #c2185b; }
        .tag-flowable { background: #f1f8e9; color: #558b2f; }
        .tag-workato { background: #e8eaf6; color: #3949ab; }
        .tag-lakera { background: #fff9c4; color: #f57f17; }
        .tag-veza { background: #e1f5fe; color: #0277bd; }
        .tag-microsoftpurview { background: #e3f2fd; color: #1976d2; }
        .feed-items {
            padding: 20px;
        }
        
        .feed-item {
            padding: 16px;
            border-left: 3px solid #667eea;
            background: #f8f9fa;
            margin-bottom: 12px;
            border-radius: 4px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .feed-item:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .feed-item h3 {
            font-size: 16px;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .feed-item a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }
        
        .feed-item a:hover {
            text-decoration: underline;
        }
        
        .feed-item .meta {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 8px;
        }
        
        .feed-item .description {
            font-size: 14px;
            color: #555;
            margin-top: 8px;
            line-height: 1.5;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
        
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 16px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #856404;
        }
        
        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s;
        }
        
        .refresh-btn:hover {
            background: #5568d3;
        }

        .expand-btn {
            background: transparent;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            margin-top: 10px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .expand-btn:hover {
            background: #667eea;
            color: white;
        }

        .expand-btn .arrow {
            transition: transform 0.3s;
            display: inline-block;
        }

        .expand-btn.active .arrow {
            transform: rotate(180deg);
        }

        .competitor-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            margin-top: 10px;
        }

        .competitor-list.show {
            max-height: 500px;
            overflow-y: auto;
        }

        .competitor-list ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .competitor-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e6ed;
            font-size: 13px;
            color: #2c3e50;
            transition: background-color 0.2s;
        }

        .competitor-list li:hover {
            background-color: #f8f9fa;
            cursor: pointer;
        }

        .competitor-list li a {
            display: block;
            width: 100%;
        }

        .competitor-list li:last-child {
            border-bottom: none;
        }

        .competitor-list .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 10px;
            margin-left: 8px;
            font-weight: 600;
        }

        .category-group {
            margin-bottom: 12px;
        }

        .category-header {
            background: #f8f9fa;
            padding: 10px 12px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
            border: 1px solid #e0e6ed;
        }

        .category-header:hover {
            background: #e9ecef;
        }

        .category-header .category-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
        }

        .category-header .category-count {
            background: #667eea;
            color: white;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .category-header .arrow {
            transition: transform 0.3s;
            font-size: 12px;
            color: #667eea;
        }

        .category-header.active .arrow {
            transform: rotate(180deg);
        }

        .category-items {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            padding-left: 20px;
        }

        .category-items.show {
            max-height: 1000px;
            padding-top: 8px;
        }

        .category-items li {
            padding: 6px 0;
            border-bottom: 1px solid #f0f3f7;
            font-size: 12px;
        }

        .back-to-top {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            text-decoration: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 12px;
            transition: all 0.3s;
        }

        .back-to-top:hover {
            background: #667eea;
            color: white;
        }

        .category-section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            margin: 30px 0 20px 0;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-section-header h2 {
            font-size: 24px;
            margin: 0;
        }

        .category-section-header .count {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .refresh-btn:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .refresh-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .refresh-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="header" id="top">
        <h1>üéØ DLP/DSPM Competitive Intelligence Dashboard</h1>
        <p>Real-time monitoring of Data Loss Prevention and Data Security Posture Management landscape</p>
    </div>
    
    <div class="note">
        <strong>üìå Note:</strong> This dashboard aggregates RSS feeds and news from major DLP/DSPM vendors. 
        Refresh this page to get the latest updates. Some feeds may take a moment to load due to CORS restrictions. 
        For best results, use the search function below to filter by keywords.
    </div>
    
    <div class="stats">
        <div class="stat-card">
            <h3>Competitors Tracked</h3>
            <div class="number" id="competitorCount">15+</div>
            <button class="expand-btn" onclick="toggleCompetitorList()">
                <span>View List</span>
                <span class="arrow">‚ñº</span>
            </button>
            <div class="competitor-list" id="competitorList">
                <ul id="competitorListItems"></ul>
            </div>
        </div>
        <div class="stat-card">
            <h3>Categories</h3>
            <div class="number" id="categoryCount">9</div>
            <button class="expand-btn" onclick="toggleCategoryList()">
                <span>View List</span>
                <span class="arrow">‚ñº</span>
            </button>
            <div class="competitor-list" id="categoryList">
                <ul id="categoryListItems"></ul>
            </div>
        </div>
        <div class="stat-card">
            <h3>News Sources</h3>
            <div class="number" id="sourceCount">8</div>
            <button class="expand-btn" onclick="toggleSourceList()">
                <span>View List</span>
                <span class="arrow">‚ñº</span>
            </button>
            <div class="competitor-list" id="sourceList">
                <ul id="sourceListItems"></ul>
            </div>
        </div>
        <div class="stat-card">
            <h3>Last Updated</h3>
            <div class="number" id="lastUpdate">Just Now</div>
        </div>
    </div>
    
    <div class="controls">
        <div style="display: flex; gap: 12px; align-items: center; margin-bottom: 12px;">
            <button id="refreshBtn" class="refresh-btn" onclick="forceRefresh()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                üîÑ Refresh Feeds
            </button>
            <span id="refreshStatus" style="font-size: 13px; color: #7f8c8d;"></span>
        </div>
        <input type="text" id="searchInput" placeholder="üîç Search by keyword (e.g., 'Shadow AI', 'funding', 'product launch')...">
    </div>
    
    <div class="feed-container" id="feedContainer">
        <div class="loading">Loading competitive intelligence feeds...</div>
    </div>

    <script src="config.js"></script>
    <script>
        // Competitive Intelligence Sources
        const competitorFeeds = [
            {
                name: 'Nightfall AI',
                tag: 'nightfallai',
                feeds: [
                    'https://www.nightfall.ai/blog/feed',
                    'https://news.google.com/rss/search?q="Nightfall+AI"+(DLP+OR+"data+loss+prevention")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Varonis',
                tag: 'varonis',
                feeds: [
                    'https://www.varonis.com/blog/feed',
                    'https://news.google.com/rss/search?q=Varonis+(DLP+OR+"data+loss+prevention")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Forcepoint',
                tag: 'forcepoint',
                feeds: [
                    'https://news.google.com/rss/search?q=Forcepoint+(DLP+OR+"data+loss+prevention")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Digital Guardian',
                tag: 'digitalguardian',
                feeds: [
                    'https://news.google.com/rss/search?q="Digital+Guardian"+(DLP+OR+"data+loss+prevention")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Proofpoint',
                tag: 'proofpoint',
                feeds: [
                    'https://news.google.com/rss/search?q=Proofpoint+(DLP+OR+"data+loss+prevention")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Symantec DLP',
                tag: 'symantecdlp',
                feeds: [
                    'https://news.google.com/rss/search?q="Symantec+DLP"+(DLP+OR+"data+loss+prevention")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Cyera',
                tag: 'cyera',
                feeds: [
                    'https://www.cyera.com/blog/feed',
                    'https://news.google.com/rss/search?q=Cyera+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'BigID',
                tag: 'bigid',
                feeds: [
                    'https://bigid.com/blog/feed/',
                    'https://news.google.com/rss/search?q=BigID+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Sentra',
                tag: 'sentra',
                feeds: [
                    'https://www.sentra.io/blog/feed',
                    'https://news.google.com/rss/search?q=Sentra+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Normalyze',
                tag: 'normalyze',
                feeds: [
                    'https://news.google.com/rss/search?q=Normalyze+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Laminar',
                tag: 'laminar',
                feeds: [
                    'https://news.google.com/rss/search?q=Laminar+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Dig Security',
                tag: 'digsecurity',
                feeds: [
                    'https://news.google.com/rss/search?q="Dig+Security"+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Polar Security',
                tag: 'polarsecurity',
                feeds: [
                    'https://news.google.com/rss/search?q="Polar+Security"+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Securiti.ai',
                tag: 'securitiai',
                feeds: [
                    'https://news.google.com/rss/search?q=Securiti.ai+(DSPM+OR+"data+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Netskope',
                tag: 'netskope',
                feeds: [
                    'https://www.netskope.com/feed',
                    'https://news.google.com/rss/search?q=Netskope+(CASB+OR+SASE+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Zscaler',
                tag: 'zscaler',
                feeds: [
                    'https://www.zscaler.com/blogs/feeds/security-research',
                    'https://news.google.com/rss/search?q=Zscaler+(CASB+OR+SASE+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Skyhigh Security',
                tag: 'skyhighsecurity',
                feeds: [
                    'https://news.google.com/rss/search?q="Skyhigh+Security"+(CASB+OR+SASE+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Wiz',
                tag: 'wiz',
                feeds: [
                    'https://www.wiz.io/blog/rss',
                    'https://news.google.com/rss/search?q=Wiz+("cloud+security"+OR+DSPM)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Lacework',
                tag: 'lacework',
                feeds: [
                    'https://news.google.com/rss/search?q=Lacework+("cloud+security"+OR+DSPM)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Orca Security',
                tag: 'orcasecurity',
                feeds: [
                    'https://news.google.com/rss/search?q="Orca+Security"+("cloud+security"+OR+DSPM)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'CrowdStrike',
                tag: 'crowdstrike',
                feeds: [
                    'https://www.crowdstrike.com/blog/feed/',
                    'https://news.google.com/rss/search?q=CrowdStrike+(EDR+OR+"endpoint+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'SentinelOne',
                tag: 'sentinelone',
                feeds: [
                    'https://news.google.com/rss/search?q=SentinelOne+(EDR+OR+"endpoint+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Code42',
                tag: 'code42',
                feeds: [
                    'https://www.code42.com/blog/feed/',
                    'https://news.google.com/rss/search?q=Code42+(EDR+OR+"endpoint+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'SquareX',
                tag: 'squarex',
                feeds: [
                    'https://news.google.com/rss/search?q=SquareX+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Island',
                tag: 'island',
                feeds: [
                    'https://www.island.io/blog/feed',
                    'https://news.google.com/rss/search?q=Island+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Talon',
                tag: 'talon',
                feeds: [
                    'https://news.google.com/rss/search?q=Talon+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'LayerX Security',
                tag: 'layerxsecurity',
                feeds: [
                    'https://www.layerxsecurity.com/blog/feed',
                    'https://news.google.com/rss/search?q="LayerX+Security"+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Seraphic Security',
                tag: 'seraphicsecurity',
                feeds: [
                    'https://seraphicsecurity.com/blog/feed',
                    'https://news.google.com/rss/search?q="Seraphic+Security"+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Surf Security',
                tag: 'surfsecurity',
                feeds: [
                    'https://www.surf.security/blog/feed',
                    'https://news.google.com/rss/search?q="Surf+Security"+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Menlo Security',
                tag: 'menlosecurity',
                feeds: [
                    'https://www.menlosecurity.com/blog/feed/',
                    'https://news.google.com/rss/search?q="Menlo+Security"+("browser+security"+OR+DLP)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Camunda',
                tag: 'camunda',
                feeds: [
                    'https://camunda.com/feed/',
                    'https://news.google.com/rss/search?q=Camunda+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'ProcessMaker',
                tag: 'processmaker',
                feeds: [
                    'https://www.processmaker.com/blog/feed/',
                    'https://news.google.com/rss/search?q=ProcessMaker+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Appian',
                tag: 'appian',
                feeds: [
                    'https://www.appian.com/blog/feed/',
                    'https://news.google.com/rss/search?q=Appian+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Pega',
                tag: 'pega',
                feeds: [
                    'https://news.google.com/rss/search?q=Pega+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Nintex',
                tag: 'nintex',
                feeds: [
                    'https://www.nintex.com/blog/feed/',
                    'https://news.google.com/rss/search?q=Nintex+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Bizagi',
                tag: 'bizagi',
                feeds: [
                    'https://www.bizagi.com/en/blog/feed',
                    'https://news.google.com/rss/search?q=Bizagi+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Flowable',
                tag: 'flowable',
                feeds: [
                    'https://www.flowable.com/blog/feed',
                    'https://news.google.com/rss/search?q=Flowable+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Workato',
                tag: 'workato',
                feeds: [
                    'https://www.workato.com/blog/feed/',
                    'https://news.google.com/rss/search?q=Workato+(workflow+OR+BPM+OR+automation)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Lakera',
                tag: 'lakera',
                feeds: [
                    'https://news.google.com/rss/search?q=Lakera+("AI+security"+OR+"LLM+security")+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Veza',
                tag: 'veza',
                feeds: [
                    'https://news.google.com/rss/search?q=Veza+(security)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
            {
                name: 'Microsoft Purview',
                tag: 'microsoftpurview',
                feeds: [
                    'https://news.google.com/rss/search?q="Microsoft+Purview"+(security)+-jobs&hl=en-US&gl=US&ceid=US:en',
                ]
            },
        ];
        
        let allFeeds = [];
        const CACHE_KEY = 'competitorFeeds_cache';
        const CACHE_TIMESTAMP_KEY = 'competitorFeeds_lastRefresh';
        const CACHE_DURATION_MS = 60 * 60 * 1000; // 1 hour in milliseconds

        // Cache management functions
        function saveToCache(data) {
            try {
                localStorage.setItem(CACHE_KEY, JSON.stringify(data));
                localStorage.setItem(CACHE_TIMESTAMP_KEY, Date.now().toString());
                console.log('‚úì Saved feeds to cache');
            } catch (error) {
                console.error('Failed to save to cache:', error);
            }
        }

        function loadFromCache() {
            try {
                const cached = localStorage.getItem(CACHE_KEY);
                const timestamp = localStorage.getItem(CACHE_TIMESTAMP_KEY);

                if (cached && timestamp) {
                    const cacheAge = Date.now() - parseInt(timestamp);
                    console.log(`Cache age: ${Math.round(cacheAge / 1000 / 60)} minutes`);
                    return {
                        data: JSON.parse(cached),
                        timestamp: parseInt(timestamp),
                        age: cacheAge
                    };
                }
            } catch (error) {
                console.error('Failed to load from cache:', error);
            }
            return null;
        }

        function canRefresh() {
            const cache = loadFromCache();
            if (!cache || !cache.data) return true; // No cache, can refresh

            // Check if ANY feed needs refreshing
            const now = Date.now();
            const hasStaleFeeds = cache.data.some(feed => {
                return !feed.lastUpdated || (now - feed.lastUpdated) >= CACHE_DURATION_MS;
            });

            return hasStaleFeeds;
        }

        function updateRefreshButton() {
            const btn = document.getElementById('refreshBtn');
            const status = document.getElementById('refreshStatus');
            const cache = loadFromCache();

            if (!cache || !cache.data || cache.data.length === 0) {
                btn.disabled = false;
                btn.style.opacity = '1';
                btn.style.cursor = 'pointer';
                status.textContent = 'No cache - ready to load';
                return;
            }

            // Find the oldest feed that needs refresh and the newest feed
            const now = Date.now();
            let oldestNeedingRefresh = null;
            let newestFeed = 0;
            let staleCount = 0;

            cache.data.forEach(feed => {
                if (feed.lastUpdated) {
                    const age = now - feed.lastUpdated;
                    if (age > newestFeed) {
                        newestFeed = age;
                    }
                    if (age >= CACHE_DURATION_MS) {
                        staleCount++;
                        if (!oldestNeedingRefresh || age > oldestNeedingRefresh) {
                            oldestNeedingRefresh = age;
                        }
                    }
                }
            });

            const totalFeeds = cache.data.length;

            if (staleCount > 0) {
                btn.disabled = false;
                btn.style.opacity = '1';
                btn.style.cursor = 'pointer';
                const hours = Math.floor(oldestNeedingRefresh / 1000 / 60 / 60);
                const minutes = Math.floor(oldestNeedingRefresh / 1000 / 60);
                status.textContent = `${staleCount} feed${staleCount > 1 ? 's' : ''} ready to refresh (oldest: ${hours > 0 ? hours + 'h' : minutes + 'm'})`;
                status.style.color = '#27ae60';
            } else {
                // Find time until oldest feed can be refreshed
                let oldestAge = 0;
                cache.data.forEach(feed => {
                    if (feed.lastUpdated) {
                        const age = now - feed.lastUpdated;
                        if (age > oldestAge) oldestAge = age;
                    }
                });

                const remainingMs = CACHE_DURATION_MS - oldestAge;
                const remainingMin = Math.ceil(remainingMs / 1000 / 60);
                const oldestMin = Math.floor(oldestAge / 1000 / 60);

                btn.disabled = true;
                btn.style.opacity = '0.5';
                btn.style.cursor = 'not-allowed';
                status.textContent = `All feeds fresh (newest: ${oldestMin}m ago) - Wait ${remainingMin}m`;
                status.style.color = '#e67e22';
            }
        }

        function forceRefresh() {
            if (!canRefresh()) {
                alert('All feeds are fresh! Please wait at least 1 hour since the last update before refreshing.');
                return;
            }
            console.log('Starting manual refresh...');
            loadFeeds(true); // Force refresh
        }

        // RSS Parser using RSS2JSON service (free API)
        async function fetchFeed(url, companyName, tag, source = 'blog') {
            try {
                const apiKey = CONFIG?.RSS2JSON_API_KEY || 'YOUR_API_KEY_HERE';
                const rss2jsonUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}&api_key=${apiKey}&count=5`;
                const response = await fetch(rss2jsonUrl);

                // Check for rate limiting (429)
                if (response.status === 429) {
                    console.warn(`‚ö†Ô∏è  Rate limited on ${source} for ${companyName}`);
                    return {
                        company: companyName,
                        tag: tag,
                        source: source,
                        rateLimited: true,
                        items: []
                    };
                }

                const data = await response.json();

                if (data.status === 'ok') {
                    return {
                        company: companyName,
                        tag: tag,
                        source: source,
                        rateLimited: false,
                        items: data.items.map(item => ({
                            title: item.title,
                            link: item.link,
                            description: item.description?.replace(/<[^>]*>/g, '').substring(0, 200) + '...',
                            pubDate: new Date(item.pubDate),
                            company: companyName,
                            source: source
                        }))
                    };
                } else {
                    console.warn(`API returned error for ${companyName} ${source}:`, data.message || data.status);
                }
            } catch (error) {
                console.error(`Error fetching ${companyName}:`, error);
            }
            return null;
        }
        
        // Helper function to delay between API calls
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize dashboard
        async function loadFeeds(forceRefresh = false) {
            const container = document.getElementById('feedContainer');

            // Check cache first unless forcing refresh
            if (!forceRefresh) {
                const cache = loadFromCache();
                if (cache && cache.age < CACHE_DURATION_MS) {
                    console.log('‚úì Loading from cache (age: ' + Math.round(cache.age / 1000 / 60) + ' minutes)');
                    container.innerHTML = '<div class="loading">Loading from cache...</div>';

                    // Restore dates from cached data
                    allFeeds = cache.data.map(feed => ({
                        ...feed,
                        blogItems: feed.blogItems.map(item => ({
                            ...item,
                            pubDate: new Date(item.pubDate)
                        })),
                        googleNewsItems: feed.googleNewsItems.map(item => ({
                            ...item,
                            pubDate: new Date(item.pubDate)
                        })),
                        items: feed.items.map(item => ({
                            ...item,
                            pubDate: new Date(item.pubDate)
                        }))
                    }));

                    renderFeeds(allFeeds);
                    setupSearch();
                    updateLastUpdated();
                    updateRefreshButton();
                    return;
                }
            }

            // Fetch fresh data
            console.log(`Starting to load ${competitorFeeds.length} competitors...`);
            container.innerHTML = '<div class="loading">Loading competitive intelligence...<br><small>This may take 2-3 minutes to avoid rate limits</small></div>';

            allFeeds = [];
            let totalFetched = 0;
            const totalFeeds = competitorFeeds.reduce((sum, c) => sum + c.feeds.length, 0);

            // Load all feeds - separate blog and Google News feeds
            for (const competitor of competitorFeeds) {
                let blogItems = [];
                let googleNewsItems = [];
                let blogRateLimited = false;
                let googleNewsRateLimited = false;

                // Check if this feed needs refreshing
                const cache = loadFromCache();
                const cachedFeed = cache?.data.find(f => f.company === competitor.name);
                const needsRefresh = !cachedFeed || !cachedFeed.lastUpdated || (Date.now() - cachedFeed.lastUpdated) >= CACHE_DURATION_MS;

                if (!needsRefresh && cachedFeed) {
                    console.log(`Skipping ${competitor.name} - last updated ${Math.round((Date.now() - cachedFeed.lastUpdated) / 60000)}m ago`);
                    // Use cached data
                    allFeeds.push({
                        ...cachedFeed,
                        blogItems: cachedFeed.blogItems.map(item => ({...item, pubDate: new Date(item.pubDate)})),
                        googleNewsItems: cachedFeed.googleNewsItems.map(item => ({...item, pubDate: new Date(item.pubDate)})),
                        items: cachedFeed.items.map(item => ({...item, pubDate: new Date(item.pubDate)}))
                    });
                    continue;
                }

                console.log(`Loading feeds for ${competitor.name}...`);

                // Fetch each feed URL with delay to avoid rate limiting
                for (let i = 0; i < competitor.feeds.length; i++) {
                    const feedUrl = competitor.feeds[i];
                    const isGoogleNews = feedUrl.includes('news.google.com');
                    const source = isGoogleNews ? 'google-news' : 'blog';

                    totalFetched++;
                    container.innerHTML = `<div class="loading">Loading competitive intelligence...<br><small>Progress: ${totalFetched}/${totalFeeds} feeds (${competitor.name})</small></div>`;

                    console.log(`  Fetching ${source} feed: ${feedUrl.substring(0, 60)}...`);

                    const feedData = await fetchFeed(feedUrl, competitor.name, competitor.tag, source);

                    if (feedData) {
                        if (feedData.rateLimited) {
                            console.log(`  ‚ö†Ô∏è  Rate limited on ${source}`);
                            if (isGoogleNews) {
                                googleNewsRateLimited = true;
                            } else {
                                blogRateLimited = true;
                            }
                        } else if (feedData.items && feedData.items.length > 0) {
                            console.log(`  ‚úì Got ${feedData.items.length} items from ${source}`);
                            if (isGoogleNews) {
                                googleNewsItems.push(...feedData.items);
                            } else {
                                blogItems.push(...feedData.items);
                            }
                        } else {
                            console.log(`  ‚úó No items from ${source}`);
                        }
                    } else {
                        console.log(`  ‚úó Failed to fetch ${source}`);
                    }

                    // Add 1 second delay between each API call to avoid rate limiting
                    if (i < competitor.feeds.length - 1 || totalFetched < totalFeeds) {
                        await delay(1000);
                    }
                }

                console.log(`${competitor.name}: ${blogItems.length} blog items, ${googleNewsItems.length} Google News items`);

                // Determine last updated time - only update if we got new data
                let lastUpdated = Date.now();
                const hasNewData = (blogItems.length > 0 || googleNewsItems.length > 0) && !blogRateLimited && !googleNewsRateLimited;

                // Check if we have cached data for this competitor
                if (cache && !hasNewData) {
                    // If we didn't get new data, keep the old timestamp
                    const cachedFeed = cache.data.find(f => f.company === competitor.name);
                    if (cachedFeed && cachedFeed.lastUpdated) {
                        lastUpdated = cachedFeed.lastUpdated;
                    }
                }

                // Create feed object with separated items
                allFeeds.push({
                    company: competitor.name,
                    tag: competitor.tag,
                    blogItems: blogItems,
                    googleNewsItems: googleNewsItems,
                    blogRateLimited: blogRateLimited,
                    googleNewsRateLimited: googleNewsRateLimited,
                    lastUpdated: lastUpdated,
                    items: [...blogItems, ...googleNewsItems] // Combined for search functionality
                });
            }

            console.log(`Finished loading ${allFeeds.length} feeds. Total items:`, allFeeds.reduce((sum, f) => sum + f.items.length, 0));

            // Save to cache
            saveToCache(allFeeds);

            renderFeeds(allFeeds);
            setupSearch();
            updateLastUpdated();
            updateRefreshButton();
        }
        
        function renderFeeds(feeds) {
            const container = document.getElementById('feedContainer');

            if (feeds.length === 0) {
                container.innerHTML = `
                    <div class="note">
                        <strong>‚ö†Ô∏è Setup Required:</strong> This dashboard uses RSS2JSON API.
                        To activate live feeds, get a free API key from <a href="https://rss2json.com" target="_blank">rss2json.com</a>
                        and replace 'YOUR_API_KEY' in the code.<br><br>
                        <strong>Manual Alternative:</strong> Visit these sources directly:
                        <ul style="margin-top: 10px;">
                            <li><a href="https://www.nightfall.ai/blog" target="_blank">Nightfall Blog</a></li>
                            <li><a href="https://news.google.com/search?q=data%20loss%20prevention" target="_blank">Google News - DLP</a></li>
                            <li><a href="https://www.varonis.com/blog" target="_blank">Varonis Blog</a></li>
                            <li><a href="https://www.code42.com/blog" target="_blank">Code42 Blog</a></li>
                        </ul>
                    </div>
                `;
                return;
            }

            container.innerHTML = '';

            // Filter out news/funding sections and group by category
            const feedsWithCategories = feeds
                .filter(feed => !feed.company.includes('News') && !feed.company.includes('Funding'))
                .map(feed => ({
                    ...feed,
                    category: getCategoryForCompany(feed.company)
                }));

            // Group by category
            const grouped = {};
            feedsWithCategories.forEach(feed => {
                if (!grouped[feed.category]) {
                    grouped[feed.category] = [];
                }
                grouped[feed.category].push(feed);
            });

            // Sort categories by number of companies
            const sortedCategories = Object.entries(grouped).sort((a, b) => b[1].length - a[1].length);

            // Render each category
            sortedCategories.forEach(([category, categoryFeeds]) => {
                const categoryId = category.toLowerCase().replace(/[^a-z0-9]/g, '-');

                // Create category header
                const categoryHeader = document.createElement('div');
                categoryHeader.className = 'category-section-header';
                categoryHeader.id = `category-${categoryId}`;
                categoryHeader.innerHTML = `
                    <div>
                        <a href="#top" class="back-to-top" style="display: inline-block; margin-bottom: 8px;">‚Üë Back to Top</a>
                        <h2>${category}</h2>
                    </div>
                    <span class="count">${categoryFeeds.length} ${categoryFeeds.length === 1 ? 'company' : 'companies'}</span>
                `;
                container.appendChild(categoryHeader);

                // Render each company in this category
                categoryFeeds.sort((a, b) => a.company.localeCompare(b.company)).forEach(feed => {
                    const section = document.createElement('div');
                    section.className = 'feed-section';
                    section.id = `feed-${feed.tag}`;

                    // Separate blog items and Google News items
                    const blogItems = (feed.blogItems || []).length > 0 ? feed.blogItems : [];
                    const googleNewsItems = (feed.googleNewsItems || []).length > 0 ? feed.googleNewsItems : [];

                    // Render blog items or rate limit message
                    let blogItemsHTML = '';
                    if (feed.blogRateLimited) {
                        blogItemsHTML = `
                            <div class="feed-source-section">
                                <h3 style="color: #667eea; font-size: 14px; font-weight: 600; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">
                                    üîó Company Blog
                                </h3>
                                <div class="feed-item" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px;">
                                    <strong>‚ö†Ô∏è Rate Limited</strong>
                                    <div style="margin-top: 8px; font-size: 13px; opacity: 0.8;">
                                        RSS2JSON API rate limit reached. Please wait a few minutes and refresh, or upgrade to a paid API key.
                                    </div>
                                </div>
                            </div>
                        `;
                    } else if (blogItems.length > 0) {
                        blogItemsHTML = `
                            <div class="feed-source-section">
                                <h3 style="color: #667eea; font-size: 14px; font-weight: 600; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">
                                    üîó Company Blog
                                </h3>
                                ${blogItems.map(item => `
                                    <div class="feed-item">
                                        <h3><a href="${item.link}" target="_blank">${item.title}</a></h3>
                                        <div class="description">${item.description}</div>
                                        <div class="meta">
                                            ${item.pubDate.toLocaleDateString()} ‚Ä¢ ${feed.company}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }

                    // Render Google News items or rate limit message
                    let googleNewsItemsHTML = '';
                    if (feed.googleNewsRateLimited) {
                        googleNewsItemsHTML = `
                            <div class="feed-source-section" style="margin-top: ${blogItemsHTML ? '24px' : '0'};">
                                <h3 style="color: #4285f4; font-size: 14px; font-weight: 600; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">
                                    üì∞ Google News
                                </h3>
                                <div class="feed-item" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px;">
                                    <strong>‚ö†Ô∏è Rate Limited</strong>
                                    <div style="margin-top: 8px; font-size: 13px; opacity: 0.8;">
                                        RSS2JSON API rate limit reached. Please wait a few minutes and refresh.
                                    </div>
                                </div>
                            </div>
                        `;
                    } else if (googleNewsItems.length > 0) {
                        googleNewsItemsHTML = `
                            <div class="feed-source-section" style="margin-top: ${blogItemsHTML ? '24px' : '0'};">
                                <h3 style="color: #4285f4; font-size: 14px; font-weight: 600; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px;">
                                    üì∞ Google News
                                </h3>
                                ${googleNewsItems.map(item => `
                                    <div class="feed-item">
                                        <h3><a href="${item.link}" target="_blank">${item.title}</a></h3>
                                        <div class="description">${item.description}</div>
                                        <div class="meta">
                                            ${item.pubDate.toLocaleDateString()} ‚Ä¢ ${feed.company}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    }

                    // Show message if no items found and not rate limited
                    const noItemsHTML = !blogItemsHTML && !googleNewsItemsHTML
                        ? '<div class="feed-item" style="opacity: 0.6;">No recent updates available from RSS feeds.</div>'
                        : '';

                    // Format last updated time
                    const lastUpdated = feed.lastUpdated ? new Date(feed.lastUpdated) : null;
                    let lastUpdatedText = '';
                    if (lastUpdated) {
                        const now = Date.now();
                        const diff = now - lastUpdated.getTime();
                        const minutes = Math.floor(diff / 60000);
                        const hours = Math.floor(minutes / 60);
                        const days = Math.floor(hours / 24);

                        if (days > 0) {
                            lastUpdatedText = `${days}d ago`;
                        } else if (hours > 0) {
                            lastUpdatedText = `${hours}h ago`;
                        } else if (minutes > 0) {
                            lastUpdatedText = `${minutes}m ago`;
                        } else {
                            lastUpdatedText = 'Just now';
                        }
                    }

                    section.innerHTML = `
                        <div class="feed-header">
                            <a href="#top" class="back-to-top">‚Üë Back to Top</a>
                            <div style="flex: 1;">
                                <h2>${feed.company}</h2>
                                ${lastUpdatedText ? `<div style="font-size: 12px; color: #95a5a6; margin-top: 4px;">Last updated: ${lastUpdatedText}</div>` : ''}
                            </div>
                            <span class="company-tag tag-${feed.tag}">${feed.tag.toUpperCase()}</span>
                        </div>
                        <div class="feed-items">
                            ${blogItemsHTML}
                            ${googleNewsItemsHTML}
                            ${noItemsHTML}
                        </div>
                    `;

                    container.appendChild(section);
                });
            });
        }
        
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                
                if (!query) {
                    renderFeeds(allFeeds);
                    return;
                }
                
                const filtered = allFeeds.map(feed => ({
                    ...feed,
                    items: feed.items.filter(item => 
                        item.title.toLowerCase().includes(query) ||
                        item.description.toLowerCase().includes(query)
                    )
                })).filter(feed => feed.items.length > 0);
                
                renderFeeds(filtered);
            });
        }
        
        function updateLastUpdated() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
        }
        
        // Toggle competitor list
        function toggleCompetitorList() {
            const list = document.getElementById('competitorList');
            const btn = document.querySelector('.expand-btn');

            list.classList.toggle('show');
            btn.classList.toggle('active');

            if (list.classList.contains('show')) {
                btn.querySelector('span:first-child').textContent = 'Hide List';
            } else {
                btn.querySelector('span:first-child').textContent = 'View List';
            }
        }

        // Toggle category list
        function toggleCategoryList() {
            const list = document.getElementById('categoryList');
            const btn = document.querySelectorAll('.expand-btn')[1]; // Second button

            list.classList.toggle('show');
            btn.classList.toggle('active');

            if (list.classList.contains('show')) {
                btn.querySelector('span:first-child').textContent = 'Hide List';
            } else {
                btn.querySelector('span:first-child').textContent = 'View List';
            }
        }

        // Toggle source list
        function toggleSourceList() {
            const list = document.getElementById('sourceList');
            const btn = document.querySelectorAll('.expand-btn')[2]; // Third button

            list.classList.toggle('show');
            btn.classList.toggle('active');

            if (list.classList.contains('show')) {
                btn.querySelector('span:first-child').textContent = 'Hide List';
            } else {
                btn.querySelector('span:first-child').textContent = 'View List';
            }
        }

        // Get category from companies config
        function getCategoryForCompany(companyName) {
            const categories = {
                'DLP': ['Nightfall AI', 'Varonis', 'Forcepoint', 'Digital Guardian', 'Proofpoint', 'Symantec DLP'],
                'DSPM': ['Cyera', 'BigID', 'Sentra', 'Normalyze', 'Laminar', 'Dig Security', 'Polar Security', 'Securiti.ai'],
                'CASB/SASE': ['Netskope', 'Zscaler', 'Skyhigh Security'],
                'Cloud Security': ['Wiz', 'Lacework', 'Orca Security'],
                'Endpoint/EDR': ['CrowdStrike', 'SentinelOne', 'Code42'],
                'Browser Security': ['SquareX', 'Island', 'Talon', 'LayerX Security', 'Seraphic Security', 'Surf Security', 'Menlo Security'],
                'Workflow/BPM': ['Camunda', 'ProcessMaker', 'Appian', 'Pega', 'Nintex', 'Bizagi', 'Flowable', 'Workato'],
                'AI Security': ['Lakera'],
                'Other': ['Veza', 'Microsoft Purview']
            };

            for (const [category, companies] of Object.entries(categories)) {
                if (companies.some(c => companyName.includes(c) || c.includes(companyName))) {
                    return category;
                }
            }
            return 'Other';
        }

        // Populate competitor list with nested categories
        function populateCompetitorList() {
            const listContainer = document.getElementById('competitorListItems');
            const count = document.getElementById('competitorCount');

            // Create unique list of competitors (exclude news feeds)
            const competitors = [];
            competitorFeeds.forEach(feed => {
                if (!feed.name.includes('News') && !feed.name.includes('Funding') &&
                    !competitors.find(c => c.name === feed.name)) {
                    competitors.push({
                        ...feed,
                        category: getCategoryForCompany(feed.name)
                    });
                }
            });

            count.textContent = competitors.length;

            // Group by category
            const grouped = {};
            competitors.forEach(comp => {
                if (!grouped[comp.category]) {
                    grouped[comp.category] = [];
                }
                grouped[comp.category].push(comp);
            });

            // Sort categories by company count
            const sortedCategories = Object.entries(grouped)
                .sort((a, b) => b[1].length - a[1].length);

            listContainer.innerHTML = sortedCategories.map(([category, comps]) => `
                <div class="category-group">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <div>
                            <span class="category-name">${category}</span>
                            <span class="category-count">${comps.length}</span>
                        </div>
                        <span class="arrow">‚ñº</span>
                    </div>
                    <ul class="category-items">
                        ${comps.sort((a, b) => a.name.localeCompare(b.name)).map(comp => `
                            <li>
                                <a href="#feed-${comp.tag}" style="color: inherit; text-decoration: none;">
                                    ${comp.name}
                                </a>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');
        }

        // Populate category list
        function populateCategoryList() {
            const listContainer = document.getElementById('categoryListItems');
            const count = document.getElementById('categoryCount');

            // Group competitors by category
            const categoryCounts = {};
            competitorFeeds.forEach(feed => {
                if (!feed.name.includes('News') && !feed.name.includes('Funding')) {
                    const category = getCategoryForCompany(feed.name);
                    categoryCounts[category] = (categoryCounts[category] || 0) + 1;
                }
            });

            const categories = Object.entries(categoryCounts).sort((a, b) => b[1] - a[1]);
            count.textContent = categories.length;

            listContainer.innerHTML = categories.map(([category, compCount]) => {
                const categoryId = category.toLowerCase().replace(/[^a-z0-9]/g, '-');
                return `
                    <li style="display: flex; justify-content: space-between; align-items: center;">
                        <a href="#category-${categoryId}" style="color: inherit; text-decoration: none; flex: 1;">
                            ${category}
                        </a>
                        <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">${compCount}</span>
                    </li>
                `;
            }).join('');
        }

        // Populate source list grouped by category
        function populateSourceList() {
            const listContainer = document.getElementById('sourceListItems');
            const count = document.getElementById('sourceCount');

            // Collect all feeds with categories
            const allFeeds = [];
            competitorFeeds.forEach(feed => {
                const category = getCategoryForCompany(feed.name);
                feed.feeds.forEach(url => {
                    allFeeds.push({
                        url: url,
                        company: feed.name,
                        tag: feed.tag,
                        category: category,
                        isGoogleNews: url.includes('news.google.com')
                    });
                });
            });

            count.textContent = allFeeds.length;

            // Group by category
            const grouped = {};
            allFeeds.forEach(feed => {
                if (!feed.company.includes('News') && !feed.company.includes('Funding')) {
                    if (!grouped[feed.category]) {
                        grouped[feed.category] = [];
                    }
                    grouped[feed.category].push(feed);
                }
            });

            // Sort categories by feed count
            const sortedCategories = Object.entries(grouped)
                .sort((a, b) => b[1].length - a[1].length);

            listContainer.innerHTML = sortedCategories.map(([category, feeds]) => `
                <div class="category-group">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <div>
                            <span class="category-name">${category}</span>
                            <span class="category-count">${feeds.length}</span>
                        </div>
                        <span class="arrow">‚ñº</span>
                    </div>
                    <ul class="category-items">
                        ${feeds.map(feed => {
                            const displayUrl = feed.url.length > 50 ? feed.url.substring(0, 47) + '...' : feed.url;
                            const icon = feed.isGoogleNews ? 'üì∞' : 'üîó';
                            return `
                                <li style="margin-bottom: 8px;">
                                    <div style="font-weight: 600; color: #2c3e50; font-size: 11px;">
                                        ${icon} ${feed.company}
                                    </div>
                                    <div style="color: #7f8c8d; font-size: 10px; padding-left: 16px; word-break: break-all;">
                                        <a href="${feed.url}" target="_blank" style="color: #667eea; text-decoration: none;">
                                            ${displayUrl}
                                        </a>
                                    </div>
                                </li>
                            `;
                        }).join('')}
                    </ul>
                </div>
            `).join('');
        }

        // Toggle individual category within a list
        function toggleCategory(header) {
            const items = header.nextElementSibling;
            header.classList.toggle('active');
            items.classList.toggle('show');
        }

        // Test if JavaScript is running
        console.log("=== SCRIPT LOADED ===");
        console.log("Total competitors:", competitorFeeds.length);

        // Load feeds on page load
        loadFeeds();
        populateCompetitorList();
        populateCategoryList();
        populateSourceList();

        // Update refresh button status every minute
        setInterval(updateRefreshButton, 60 * 1000);

        // Note: Removed auto-refresh to respect rate limits
        // Use the manual refresh button instead
    </script>
</body>
</html>
